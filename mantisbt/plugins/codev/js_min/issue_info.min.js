function removeFromCmd(e,t){jQuery("#formRemoveFromCmd_cmdName").text(t),jQuery("#formRemoveFromCmd").find("input[name=cmdid]").val(e),jQuery("#formRemoveFromCmd_dialog").dialog("open")}function updateGeneralInfo(e){jQuery.ajax({type:"GET",url:"reports/issue_info_ajax.php",data:"action=getGeneralInfo&bugid="+e,success:function(e){jQuery("#issueGeneralInfo").html(jQuery.trim(e)),updateWidgets("#issueGeneralInfo")},error:function(e,t,a){"Forbidden"==a?window.location=issueInfoSmartyData.page:alert(a)}})}jQuery(document).ready(function(){function e(e,t,a,r){return!!t.test(e.val())||(e.addClass("ui-state-error"),a.text(r),!1)}function t(e,t){return s<r&&s>i&&0==e.val()?(e.addClass("ui-state-error"),t.text(issueInfoSmartyData.i18n_checkStatus01),!1):(s>=r&&0!=e.val()&&(e.addClass("ui-state-error"),t.text(issueInfoSmartyData.i18n_checkStatus02)),!(s==i&&0<e.val())||(e.addClass("ui-state-error"),t.text(issueInfoSmartyData.i18n_checkStatus03+o),!1))}function a(){var a=!0,r=jQuery("#fut_validateTips");return l.removeClass("ui-state-error"),r.text(""),issueInfoSmartyData.isManager&&(a=a&&e(n,/^[0-9]+(\.[0-9][0-9]?5?)?$/i,r,"format:  '1',  '0.3'  or  '2.55' or '2.125'")),a=a&&e(d,/^[0-9]+(\.[0-9][0-9]?5?)?$/i,r,"format:  '1',  '0.3'  or  '2.55' or '2.125'"),a=a&&t(u,r),s>i&&null!=u.val()&&(a=a&&e(u,/^[0-9]+(\.[0-9][0-9]?5?)?$/i,r,"format:  '1',  '0.3'  or  '2.55' or '2.125'")),a}"en"!=issueInfoSmartyData.datepickerLocale&&jQuery.datepicker.setDefaults($.datepicker.regional[issueInfoSmartyData.datepickerLocale]),jQuery("#projectid").change(function(){var e=jQuery(this).val(),t=jQuery("#bugid").val();null===t&&(t="0"),jQuery.ajax({type:"GET",url:"smarty_tools_ajax.php",data:"action=getProjectIssues&projectid="+e+"&bugid="+t,success:function(e){jQuery("#bugSelector").html(jQuery.trim(e)),updateWidgets("#bugSelector"),jQuery("#result").hide()},error:function(e,t,a){"Forbidden"===a?window.location=issueInfoSmartyData.page:(console.error(t,a),alert(a))}})}),jQuery("#bugid").change(function(){console.log("submit form1"),"0"!==this.value&&jQuery("#form1").submit()});var r,i,o,s,u=jQuery("#fut_backlog"),n=jQuery("#fut_issueMgrEffortEstim"),d=jQuery("#fut_issueEffortEstim"),l=jQuery([]).add(u).add(n).add(d);jQuery("#updateTimetracking_link").click(function(e){e.preventDefault(),jQuery.ajax({type:"GET",url:issueInfoSmartyData.ajaxPage,data:"action=getTimetracking&bugid="+issueInfoSmartyData.bugid,dataType:"json",success:function(e){"SUCCESS"===e.statusMsg?(n.val(e.issueMgrEffortEstim),d.val(e.issueEffortEstim),u.val(e.issueBacklog),r=e.bugResolvedStatusThreshold,i=e.bugStatusNew,o=e.statusNameNew,s=e.issueCurrentStatus,t(u,jQuery("#fut_validateTips")),jQuery("#formUpdateTimetracking_dialog").dialog("open")):(console.error("Ajax statusMsg",e.statusMsg),alert(e.statusMsg))},error:function(e,t,a){console.error(t,a),alert("ERROR: Please contact your CodevTT administrator")}})}),jQuery("#formUpdateTimetracking_dialog").dialog({autoOpen:!1,resizable:!0,width:"auto",modal:!0,buttons:[{text:issueInfoSmartyData.i18n_update,click:function(){a()&&jQuery("#formUpdateTimetracking").submit()}},{text:issueInfoSmartyData.i18n_cancel,click:function(){jQuery(this).dialog("close")}}]}),jQuery("#formUpdateTimetracking").submit(function(e){e.preventDefault();var t=jQuery(this);jQuery.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize(),dataType:"json",success:function(e){"SUCCESS"===e.statusMsg?updateGeneralInfo(e.issueId):alert(e.statusMsg)},error:function(e,t,a){console.error(t,a),alert("ERROR: Please contact your CodevTT administrator")}}),jQuery("#formUpdateTimetracking_dialog").dialog("close")}),jQuery("#updateTaskInfo_link").click(function(e){e.preventDefault(),jQuery.ajax({type:"GET",url:issueInfoSmartyData.ajaxPage,data:"action=getTaskInfo&bugid="+issueInfoSmartyData.bugid,dataType:"json",success:function(e){if("SUCCESS"===e.statusMsg){jQuery("#futi_extRef").val(e.extRef),jQuery("#futi_codevttType").val(e.codevttType);var t=jQuery("#futi_cbHandlerId");t.empty(),t.append(new Option("","0"));var a=e.availableHandlerList;for(var r in a)a.hasOwnProperty(r)&&t.append(jQuery("<option>").attr("value",r).append(a[r]));t.val(e.currentHandlerId),(t=jQuery("#futi_cbStatus")).empty(),a=e.availableStatusList;for(var r in a)a.hasOwnProperty(r)&&t.append(jQuery("<option>").attr("value",r).append(a[r]));t.val(e.currentStatus),(t=jQuery("#futi_cbTargetVersion")).empty(),t.append(new Option("","0")),a=e.availableTargetVersion;for(var r in a)a.hasOwnProperty(r)&&t.append(jQuery("<option>").attr("value",r).append(a[r]));t.val(e.targetVersionId),jQuery("#futi_deadlineDatepicker").val(e.deadline),e.deadline?(jQuery("#futi_deadlineDatepicker").val(e.deadline),jQuery("#futi_deadlineDatepicker").removeAttr("disabled"),$("#futi_isDeadline").prop("checked",!0)):($("#futi_isDeadline").prop("checked",!1),jQuery("#futi_deadlineDatepicker").attr("disabled","true")),e.deliveryDate?(jQuery("#futi_deliveryDatepicker").val(e.deliveryDate),jQuery("#futi_deliveryDatepicker").removeAttr("disabled"),$("#futi_isDelivery").attr("checked",!0)):($("#futi_isDelivery").attr("checked",!1),jQuery("#futi_deliveryDatepicker").attr("disabled","true")),jQuery("#formUpdateTaskInfo_dialog").dialog("open")}else console.error("statusMsg",e.statusMsg),alert(e.statusMsg)},error:function(e,t,a){console.error(t,a),alert("ERROR: Please contact your CodevTT administrator")}})}),jQuery("#formUpdateTaskInfo_dialog").dialog({autoOpen:!1,resizable:!0,width:"auto",modal:!0,buttons:[{text:issueInfoSmartyData.i18n_update,click:function(){jQuery("#formUpdateTaskInfo").submit()}},{text:issueInfoSmartyData.i18n_cancel,click:function(){jQuery(this).dialog("close")}}]}),jQuery("#formUpdateTaskInfo").submit(function(e){e.preventDefault();var t=jQuery(this);jQuery.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize(),dataType:"json",success:function(e){if("SUCCESS"===e.statusMsg){jQuery("#ti_issueExtRef").text(e.issueExtRef),jQuery("#ti_handlerName").text(e.handlerName),jQuery("#ti_statusName").text(e.statusName),jQuery("#ti_projectName").text(e.projectName),jQuery("#ti_categoryName").text(e.categoryName),jQuery("#ti_issueType").text(e.issueType),jQuery("#ti_priorityName").text(e.priorityName),jQuery("#ti_severityName").text(e.severityName),jQuery("#ti_targetVersion").text(e.targetVersion);var t=e.timeDrift;jQuery("#ti_deadLine").empty(),t.tooltip&&t.deadLine?jQuery("#ti_deadLine").html(t.deadLine+" "+t.tooltip):jQuery("#ti_deadLine").html(t.deadLine),updateWidgets("#divTaskInfo"),"yes"===e.isUpdateGeneralInfo&&updateGeneralInfo(e.issueId)}else console.error("statusMsg",e.statusMsg),alert(e.statusMsg)},error:function(e,t,a){console.error(t,a),alert("ERROR: Please contact your CodevTT administrator")}}),jQuery("#formUpdateTaskInfo_dialog").dialog("close")}),jQuery("#futi_isDeadline").change(function(){$(this).is(":checked")?jQuery("#futi_deadlineDatepicker").removeAttr("disabled"):jQuery("#futi_deadlineDatepicker").attr("disabled","true")}),jQuery("#futi_isDelivery").change(function(){$(this).is(":checked")?jQuery("#futi_deliveryDatepicker").removeAttr("disabled"):jQuery("#futi_deliveryDatepicker").attr("disabled","true")}),jQuery("#formRemoveFromCmd_dialog").dialog({autoOpen:!1,resizable:!0,width:"auto",modal:!0,buttons:[{text:issueInfoSmartyData.i18n_remove,click:function(){jQuery("#formRemoveFromCmd").submit()}},{text:issueInfoSmartyData.i18n_cancel,click:function(){jQuery(this).dialog("close")}}]}),jQuery("#formRemoveFromCmd").submit(function(e){e.preventDefault();var t=jQuery(this);jQuery.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize(),dataType:"json",success:function(e){if("SUCCESS"===e.statusMsg){var t=document.getElementById("divCmd_"+e.cmdid);t.parentElement.removeChild(t)}else alert(e.statusMsg)},error:function(e,t,a){console.error(t,a),alert("ERROR: Please contact your CodevTT administrator")}}),jQuery("#formRemoveFromCmd_dialog").dialog("close")}),jQuery("#addToCmd_link").click(function(e){e.preventDefault(),jQuery.ajax({type:"GET",url:issueInfoSmartyData.ajaxPage,data:"action=getCmdCandidates&bugid="+issueInfoSmartyData.bugid,dataType:"json",success:function(e){if("SUCCESS"===e.statusMsg){var t=jQuery(".cbCmdCandidates");t.empty();var a=e.cmdCandidates;for(var r in a)a.hasOwnProperty(r)&&t.append(jQuery("<option>").attr("value",r).append(a[r]))}else alert(e.statusMsg)},error:function(e,t,a){console.error(t,a),alert("ERROR: Please contact your CodevTT administrator")}}),jQuery("#formAddToCmd_dialog").dialog("open")}),jQuery("#formAddToCmd_dialog").dialog({autoOpen:!1,resizable:!0,width:"auto",modal:!0,buttons:[{text:issueInfoSmartyData.i18n_add,click:function(){jQuery("#formAddToCmd").submit()}},{text:issueInfoSmartyData.i18n_cancel,click:function(){jQuery(this).dialog("close")}}]}),jQuery("#formAddToCmd").submit(function(e){e.preventDefault();var t=jQuery(this);jQuery.ajax({type:t.attr("method"),url:t.attr("action"),data:t.serialize(),dataType:"json",success:function(e){if("SUCCESS"===e.statusMsg){var t=jQuery("<img></img>").attr("align","absmiddle").attr("title",issueInfoSmartyData.i18n_removeTaskFromCommand).attr("src","images/b_drop.png");t.attr("onclick","removeFromCmd('"+e.cmdid+"', '"+e.cmdName+"');return false;");var a=jQuery("<a></a>").attr("href","management/command_info.php?cmdid="+e.cmdid).html(e.cmdName),r=jQuery("<span></span>").addClass("pointer").append(t),i=jQuery("<div></div>").attr("id","divCmd_"+e.cmdid).append(r).append(a);jQuery("#cmdList").append(i)}else alert(e.statusMsg)},error:function(e,t,a){console.error(t,a),alert("ERROR: Please contact your CodevTT administrator")}}),jQuery("#formAddToCmd_dialog").dialog("close")}),jQuery("#getMantisNotes_link").click(function(e){e.preventDefault(),jQuery.ajax({type:"GET",url:issueInfoSmartyData.ajaxPage,data:"action=getMantisNotes&bugid="+issueInfoSmartyData.bugid,dataType:"json",success:function(e){"SUCCESS"===e.statusMsg?(jQuery("#divNotesInfo").hide(),jQuery("#divNotesTable").show(),jQuery("#tableMantisNotes tbody tr").remove(),jQuery.each(e.taskNotes,function(e,t){var a=jQuery("<tr>").append(jQuery("<td>").text(t.dateSubmitted),jQuery("<td>").text(t.reporterName),jQuery("<td>").text(t.originTag),jQuery("<td>").html(t.text)).wrap("<p>");jQuery("#tableMantisNotes tbody").append(a)}),jQuery.ajax({async:!1,url:"js_min/datatable.min.js",dataType:"script"})):(console.error("Ajax statusMsg",e.statusMsg),alert(e.statusMsg))},error:function(e,t,a){console.error(t,a),alert("ERROR: Please contact your CodevTT administrator")}})})});